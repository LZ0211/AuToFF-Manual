常见问题
************************************

**上传文件无显示？**
=================================

通常原因都是文件格式不规范导致的，AuToFF开发的时候严格基于文件的官方格式文档，对于一些不规范的格式兼容性较差，多见于pdb格式（symbol列没有写）和cif格式（结构未精修，存在分数占据）。用户可以检查文件格式，或者用其他软件，如VESTA打开后重新保存为其他格式。

还有一种可能的原因就体系的原子数目太多，目前为了满足大部分用户需求以及保证用户体验，限制上传的结构不超过1000个原子。对于聚合物等大体系可以在聚合物模块让AuToFF来搭建结构，而不要建完模型再上传，因为通过AuToFF的聚合物模块来搭建结构，程序可以充分利用标度算法来减少原子类型识别和原子电荷计算的计算量。对于晶体材料，可以先上传结构较小的晶胞，待最后一步生成对应分子动力学模拟软件的拓扑格式的时候，通过扩胞来创建更大的体系。

**识别完原子类型之后，无法点击下一步操作？**
==========================================

如果当前的结构中有原子是选择力场中不支持的，程序自动会禁止下一步操作。用户需要返回上一步，更换其他的力场，或者添加备选的杂化力场，如UFF力场来达到能够匹配所有原子的目的。另外需要说明的是，AuToFF是基于力场规则定义好的SMART语法和当前结构中原子的连接关系来判断原子类型的，如果存在不合理的键连关系，也可能导致无法识别原子类型。用户可以通过第三方建模软件修改成键关系来进一步调整，然后重新上传结构。未来AuToFF会直接支持网页端的3d分子建模，用户编辑结构会更加容易。

**体系总电荷不为零？**
=================================

若选择力场参数有自带的电荷，如OPLS-AA，ClayFF等，且没有额外选择原子电荷的计算，那么程序不能保证所有原子的总电荷是用户期望的净电荷数。用户可以自行编辑更改电荷数达到目的，或者可以选择AuToFF支持的多种电荷计算方法，实现电荷平衡。

**导入优化后的分子结构进行力场参数生成，可以不改变键长，键角参数吗？**
========================================================================

可以实现的，考虑到用户可能已经用量子化学计算方法优化了分子结构，用户想要将DFT优化得到的键长、键角替换力场中的平衡键长和键角，用户可以在“根据力场选择原子类型”功能区的3D显示的下方，设置使用当前结构的键长，键角的操作。

.. figure:: image/使用当前结构.bmp
    :align: center

**力场参数检索方式的模糊和精确按钮如何区分？**
====================================================================

如果使用“模糊检索”，且当用户选择了备选力场进行杂化的时候，程序会按照力场的排序依次检索，如果找到了参数，就不会继续往下检索。因此当前体系不是一套力场能够完全匹配，必须使用杂化力场的时候，必须选择“模糊检索”。

如果只选择了一种力场，但是这个力场中存在多个原子类型可以匹配某一个原子的时候，如果使用“精确检索”，程序则之后使用匹配到的第一个原子类型进行参数检索（在前端界面上，用户可以点击对应的原子更换优先级）。如果使用“模糊检索”，则程序会按照匹配到的原子类型的优先级，依次进行参数的检索，指直到找到参数。比如，对于羰基C=O，力场中存在精确的C=O定义和更广泛的C=定义，两种原子类型都可以匹配当前碳原子，如果选择“精确检索”，则程序只会按照C=O进行参数的检索。如果选择了“模糊检索”，那么如果当前力场库中找不到C=O相关的参数，程序会进一步检索C=的参数来将就用。

一般默认使用模糊检索即可。

**可以修改力场吗？**
=================================

“生成拓扑文件”功能区可以进行编辑修改力场参数，对于较大的体系，一一修改可能会比较繁琐，建议用户下载参数后用文本编辑器自行批量修改。


**是否支持力场参数的拟合？**
=================================

近期会上线mSeminario方法拟合力常数，但是需要用户自己上传Gaussian、ORCA等量化软件计算的Hessian文件，且保证量化计算的原子序号和上传到AuToFF的结构文件的序号保持一致。但是该方法只支持拟合bond和angle的参数。对于多重二面角的参数拟合，AuToFF计划会支持，但是由于需要调用超算资源做量化的势能面扫描，因此这个的开发计划比较后。

**CgenFF力场没有像官方那样提供电荷？**
==========================================

CgenFF的官方电荷模型是基于bond charge increasement 规则来生成了，参见文献：10.1021/ci3003649，由于文献中没有全部公开相关的BCI参数，因此用户只能通过CgenFFF官网上传结构来生成，大多数时候也可以用其他电荷模型将就使用，比如MMFF94和RESP电荷。