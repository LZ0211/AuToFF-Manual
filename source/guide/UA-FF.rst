.. _UA-FF:

联合原子力场
================================================

联合原子力场 (united-atom force fields) 与碳原子直接键连的氢原子的相对原子质量被重叠到碳原子上，形成一个联合原子的整体，同时，其他原子对氢原子的相互作用也被叠加到联合原子上，从而可以大幅度降低力场的复杂性，减少势参数，减少计算非键相互作用的数量和计算时间。在联合原子力场中，力点数少于原子数，是分子的不完全表述。
目前支持的联合原子力场包括TraPPE-UA、PDMS、OPLS-UA、OPLS-UA/BCI、Dreiding-UA、TraPPE-UA+CL&P、TraPPE-UA+OPLS-2009IL、TraPPE-UA+OPLS-2009IL/0.8、OPLS-UA+CL&P、OPLS-UA+OPLS-2009IL、OPLS-UA+OPLS-2009IL/0.8、PDMS+TraPPE-UA

.. note::
    1. TraPPE力场中所有键长被约束在平衡位置，不允许振动，不需要共价键伸缩势。因此，成键相互作用只包括键角弯曲势、二面角扭曲势和离面弯曲势三种类型。
    2. OPLS-UA力场中,所有与碳原子成键的氢原子不直接出现在力场中，而是隐含在与碳原子的力场参数中。

.. 1. GROMOS力场是用于生物分子模拟的最重要分子力场之一，其中赝扭曲势是一个非常重要的势能项，不但保证了羰基结构、芳香环结构、蛋白质骨架中酰胺基结构、DNA分子中碱基结构等平面构型，还保证了隐含一个氢原子的 :math:`SP^3` 杂化碳原子（与碳原子键联的另外三个原子为非氢原子，显式处理）的正确四面体结构，避免因为计算原因引起的光学活性中心的错误消旋。GROMOS共有三组赝扭曲势参数，其中的两组参数作用是保证分子中平面构型的正确性，剩下一组参数的作用是保证 :math:`SP^3` 杂化的四面体结构的正确性。

同全原子模块操作方法一样，首先分子的2的建模/导入分子结构，产生3d结构；然后，选择联合原子力场，点击 **下一步** 程序根据力场自动选择划分原子类型，分配力场参数，生成该分子的力场拓扑文件。 

.. figure:: image/UA-FF-创建分子结构.png
    :align: center
.. centered:: 图2.1  创建分子结构

以下图壬烷为例，简化了原子类型，两端的CH3基团当作一个联合原子整体，中间的CH2基团作为一个整体。

.. figure:: image/UA-FF-根据力场选择原子类型.png
    :align: center
.. centered:: 图2.2  根据力场选择原子类型

点击 **下一步** 即可合理产生力场参数，最终生成对应软件格式的力场拓扑文件。    
    
.. figure:: image/UA-FF-生成拓扑文件.png
    :align: center
.. centered:: 图2.3  生成拓扑文件